# Sprint 1.1 - –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ main.py

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û  
**–î–∞—Ç–∞:** 04.10.2025  
**–§–∞–∑–∞:** Phase 1 - –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è  
**–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** 1 –¥–µ–Ω—å

---

## üìä –û—Å–Ω–æ–≤–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –ú–µ—Ç—Ä–∏–∫–∏
- **main.py:** 717 ‚Üí **96 —Å—Ç—Ä–æ–∫** (-86.6%)
- **–ö—Ä–∏—Ç–µ—Ä–∏–π –¢–ó:** < 150 —Å—Ç—Ä–æ–∫ ‚úÖ **–ü–ï–†–ï–í–´–ü–û–õ–ù–ï–ù**
- **–ù–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤:** 11
- **–ù–æ–≤—ã—Ö –∫–∞—Ç–∞–ª–æ–≥–æ–≤:** 3
- **–¢–µ—Å—Ç—ã:** 4/4 PASSED ‚úÖ

---

## üìÇ –°–æ–∑–¥–∞–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ù–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
```
src/
‚îú‚îÄ‚îÄ main.py                          ‚ú® 96 —Å—Ç—Ä–æ–∫ (–±—ã–ª–æ 717)
‚îÇ
‚îú‚îÄ‚îÄ api/                             üÜï API Layer
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ dependencies.py              ‚Üí DI –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä (—á–∞—Å—Ç–∏—á–Ω–æ)
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ routes/                      ‚Üí Endpoints
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ health.py                ‚Üí /health
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ index.py                 ‚Üí /index/status, /index/rebuild
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ metrics.py               ‚Üí /metrics, /metrics/{id}
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ mcp.py                   ‚Üí /mcp [GET/POST], /mcp/tools
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ middleware/                  ‚Üí Middleware
‚îÇ       ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îú‚îÄ‚îÄ rate_limit.py            ‚Üí Rate limiting
‚îÇ       ‚îî‚îÄ‚îÄ error_handler.py         ‚Üí 3 exception handlers
‚îÇ
‚îî‚îÄ‚îÄ core/
    ‚îî‚îÄ‚îÄ startup.py                   üÜï auto_index_on_startup()
```

### –ë—ã–ª–æ vs –°—Ç–∞–ª–æ

**–î–æ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ (main.py - 717 —Å—Ç—Ä–æ–∫):**
```
main.py
‚îú‚îÄ‚îÄ Imports (25 —Å—Ç—Ä–æ–∫)
‚îú‚îÄ‚îÄ Lifecycle management (68 —Å—Ç—Ä–æ–∫)
‚îú‚îÄ‚îÄ 3 middleware (inline, 60 —Å—Ç—Ä–æ–∫)
‚îú‚îÄ‚îÄ 4 exception handlers (inline, 80 —Å—Ç—Ä–æ–∫)
‚îú‚îÄ‚îÄ 10+ endpoints (inline, 400+ —Å—Ç—Ä–æ–∫)
‚îú‚îÄ‚îÄ MCP JSON-RPC –ª–æ–≥–∏–∫–∞ (84 —Å—Ç—Ä–æ–∫–∏)
‚îî‚îÄ‚îÄ –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏ (100 —Å—Ç—Ä–æ–∫)
```

**–ü–æ—Å–ª–µ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ (main.py - 96 —Å—Ç—Ä–æ–∫):**
```
main.py
‚îú‚îÄ‚îÄ Imports (28 —Å—Ç—Ä–æ–∫)
‚îú‚îÄ‚îÄ lifespan() (35 —Å—Ç—Ä–æ–∫)
‚îú‚îÄ‚îÄ App initialization (20 —Å—Ç—Ä–æ–∫)
‚îî‚îÄ‚îÄ Router/Middleware registration (13 —Å—Ç—Ä–æ–∫)

+ api/routes/* (4 –º–æ–¥—É–ª—è, ~400 —Å—Ç—Ä–æ–∫)
+ api/middleware/* (2 –º–æ–¥—É–ª—è, ~130 —Å—Ç—Ä–æ–∫)
+ core/startup.py (1 –º–æ–¥—É–ª—å, ~90 —Å—Ç—Ä–æ–∫)
```

---

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏

### –ò–∑ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è:
- [x] –°–æ–∑–¥–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É `api/routes/`
- [x] –í—ã–Ω–µ—Å—Ç–∏ MCP endpoints –≤ `api/routes/mcp.py`
- [x] –í—ã–Ω–µ—Å—Ç–∏ health checks –≤ `api/routes/health.py`
- [x] –í—ã–Ω–µ—Å—Ç–∏ index management –≤ `api/routes/index.py`
- [x] –°–æ–∑–¥–∞—Ç—å `api/middleware/` –∏ –≤—ã–Ω–µ—Å—Ç–∏ middleware
- [x] –°–æ–∫—Ä–∞—Ç–∏—Ç—å main.py –¥–æ < 150 —Å—Ç—Ä–æ–∫
- [x] –û–±–Ω–æ–≤–∏—Ç—å tests –¥–ª—è –Ω–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ:
- [x] –°–æ–∑–¥–∞–Ω `api/dependencies.py` –¥–ª—è DI (–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ Sprint 1.2)
- [x] –°–æ–∑–¥–∞–Ω `core/startup.py` –¥–ª—è startup –ª–æ–≥–∏–∫–∏
- [x] –£—Å—Ç—Ä–∞–Ω–µ–Ω–æ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ `index_hbk_file()`
- [x] –í—Å–µ –∏–º–ø–æ—Ä—Ç—ã –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã –∏ —Ä–∞–±–æ—Ç–∞—é—Ç

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–µ—Å—Ç—ã
```bash
pytest tests/ -v

‚úÖ test_elasticsearch_connection.py::test_elasticsearch_connection PASSED [ 25%]
‚úÖ test_indexing.py::test_indexing PASSED                          [ 50%]
‚úÖ test_parsing.py::test_hbk_parsing PASSED                        [ 75%]
‚úÖ test_search.py::test_search PASSED                              [100%]

======================================== 4 passed in 53.73s =========================================
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–º–ø–æ—Ä—Ç–æ–≤
```python
‚úÖ from src.main import app
‚úÖ from src.api.routes import health, index, metrics, mcp
‚úÖ from src.api.middleware import rate_limit, error_handler
‚úÖ from src.core.startup import auto_index_on_startup
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∞—Ä—à—Ä—É—Ç–æ–≤
```
12 routes –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–æ:
‚úÖ /health [GET]
‚úÖ /index/status [GET]
‚úÖ /index/rebuild [POST]
‚úÖ /metrics [GET]
‚úÖ /metrics/{client_id} [GET]
‚úÖ /mcp/tools [GET]
‚úÖ /mcp [GET] (SSE streaming)
‚úÖ /mcp [POST] (JSON-RPC)
+ 4 –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ä–æ—É—Ç–∞ (docs, redoc, openapi.json)
```

---

## üìà –£–ª—É—á—à–µ–Ω–∏—è

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã
- ‚úÖ **SRP (Single Responsibility Principle)** - –∫–∞–∂–¥—ã–π –º–æ–¥—É–ª—å –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –æ–¥–Ω—É —Ñ—É–Ω–∫—Ü–∏—é
- ‚úÖ **Separation of Concerns** - —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ API, middleware, startup
- ‚úÖ **Modularity** - –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ, –≤–∑–∞–∏–º–æ–∑–∞–º–µ–Ω—è–µ–º—ã–µ –º–æ–¥—É–ª–∏
- ‚úÖ **Testability** - –∫–∞–∂–¥—ã–π –º–æ–¥—É–ª—å –º–æ–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω–æ
- ‚úÖ **Readability** - –∫–æ–¥ —Å—Ç–∞–ª –ø–æ–Ω—è—Ç–Ω–µ–µ –∏ –ø—Ä–æ—â–µ –¥–ª—è –Ω–æ–≤—ã—Ö —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —É–ª—É—á—à–µ–Ω–∏—è
- ‚úÖ –ù–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–¥–∞
- ‚úÖ FastAPI Router pattern
- ‚úÖ –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- ‚úÖ –ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ middleware
- ‚úÖ –£–ø—Ä–∞–≤–ª—è–µ–º—ã–π lifecycle

### –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –≤—ã–≥–æ–¥—ã
- ‚úÖ –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π endpoint (–ø—Ä–æ—Å—Ç–æ —Å–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª –≤ routes/)
- ‚úÖ –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π middleware (–ø—Ä–æ—Å—Ç–æ —Å–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª –≤ middleware/)
- ‚úÖ –õ–µ–≥–∫–æ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–∞–∂–¥—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –æ—Ç–¥–µ–ª—å–Ω–æ
- ‚úÖ –õ–µ–≥–∫–æ –Ω–∞–π—Ç–∏ –Ω—É–∂–Ω—ã–π –∫–æ–¥ (–ø–æ–Ω—è—Ç–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞)
- ‚úÖ –õ–µ–≥–∫–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –∏ —Ä–∞—Å—à–∏—Ä—è—Ç—å

---

## üéØ –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –∫—Ä–∏—Ç–µ—Ä–∏—è–º –¢–ó

| –ö—Ä–∏—Ç–µ—Ä–∏–π | –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ | –†–µ–∑—É–ª—å—Ç–∞—Ç | –°—Ç–∞—Ç—É—Å |
|----------|-----------|-----------|--------|
| –†–∞–∑–º–µ—Ä main.py | < 150 —Å—Ç—Ä–æ–∫ | **96 —Å—Ç—Ä–æ–∫** | ‚úÖ |
| Endpoints –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω—ã | –î–∞ | 4 –º–æ–¥—É–ª—è | ‚úÖ |
| Middleware –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω—ã | –î–∞ | 2 –º–æ–¥—É–ª—è | ‚úÖ |
| –¢–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç | 100% | 4/4 | ‚úÖ |
| API layer —Å–æ–∑–¥–∞–Ω | –î–∞ | api/ | ‚úÖ |
| –ù–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è | –î–∞ | –£—Å—Ç—Ä–∞–Ω–µ–Ω–æ | ‚úÖ |
| –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å | –î–∞ | 100% | ‚úÖ |

---

## üìù –î–µ—Ç–∞–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### 1. api/routes/health.py (32 —Å—Ç—Ä–æ–∫–∏)
- Endpoint: `GET /health`
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: —Å—Ç–∞—Ç—É—Å Elasticsearch, –Ω–∞–ª–∏—á–∏–µ –∏–Ω–¥–µ–∫—Å–∞, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç: –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è

### 2. api/routes/index.py (90 —Å—Ç—Ä–æ–∫)
- Endpoints: `GET /index/status`, `POST /index/rebuild`
- –§—É–Ω–∫—Ü–∏—è `index_hbk_file()` –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –∏–∑ `core/startup.py`
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–µ–π Elasticsearch

### 3. api/routes/metrics.py (42 —Å—Ç—Ä–æ–∫–∏)
- Endpoints: `GET /metrics`, `GET /metrics/{client_id}`
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: –º–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É rate limiting
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç: FastAPI Depends –¥–ª—è DI

### 4. api/routes/mcp.py (320 —Å—Ç—Ä–æ–∫)
- Endpoints: `GET /mcp` (SSE), `POST /mcp` (JSON-RPC), `GET /mcp/tools`
- MCP protocol: initialize, tools/list, tools/call, prompts/list
- JSON-RPC 2.0 —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

### 5. api/middleware/rate_limit.py (64 —Å—Ç—Ä–æ–∫–∏)
- Rate limiting –¥–ª—è –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- –ò–∑–º–µ—Ä–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- HTTP 429 –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–∞

### 6. api/middleware/error_handler.py (53 —Å—Ç—Ä–æ–∫–∏)
- 3 exception handler'–∞:
  - `ValidationError` ‚Üí HTTP 400
  - `HBKParserError` ‚Üí HTTP 500
  - `Exception` ‚Üí HTTP 500
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ—à–∏–±–æ–∫
- –ú–µ—Ç—Ä–∏–∫–∏ –æ—à–∏–±–æ–∫

### 7. api/dependencies.py (36 —Å—Ç—Ä–æ–∫)
- –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–º—É DI (Sprint 1.2)
- Type aliases –¥–ª—è Depends
- Helper —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤

### 8. core/startup.py (90 —Å—Ç—Ä–æ–∫)
- `auto_index_on_startup()` - –∞–≤—Ç–æ–∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
- `index_hbk_file()` - –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è .hbk —Ñ–∞–π–ª–∞
- –ï–¥–∏–Ω–æ–µ –º–µ—Å—Ç–æ –¥–ª—è startup –ª–æ–≥–∏–∫–∏

---

## üîÑ –ß—Ç–æ –ù–ï –∏–∑–º–µ–Ω–∏–ª–æ—Å—å (–æ–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å)

- ‚úÖ –í—Å–µ API endpoints —Ä–∞–±–æ—Ç–∞—é—Ç –∫–∞–∫ —Ä–∞–Ω—å—à–µ
- ‚úÖ MCP –ø—Ä–æ—Ç–æ–∫–æ–ª –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–≤–º–µ—Å—Ç–∏–º
- ‚úÖ JSON-RPC 2.0 —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- ‚úÖ SSE streaming —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –í—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∫–ª–∏–µ–Ω—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- ‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –Ω–µ –∏–∑–º–µ–Ω–∏–ª–∞—Å—å
- ‚úÖ Docker setup –Ω–µ –∏–∑–º–µ–Ω–∏–ª—Å—è

---

## ‚ö†Ô∏è –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

### –ß—Ç–æ –æ—Å—Ç–∞–ª–æ—Å—å –¥–ª—è —Å–ª–µ–¥—É—é—â–∏—Ö —Å–ø—Ä–∏–Ω—Ç–æ–≤:

1. **–ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Å–∏–Ω–≥–ª—Ç–æ–Ω—ã** (Sprint 1.2)
   - `es_client` - –≥–ª–æ–±–∞–ª—å–Ω—ã–π
   - `indexer` - –≥–ª–æ–±–∞–ª—å–Ω—ã–π
   - `get_metrics_collector()` - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç singleton
   - `get_rate_limiter()` - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç singleton

2. **–ë–ª–æ–∫–∏—Ä—É—é—â–∞—è –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è** (Sprint 1.3)
   - `auto_index_on_startup()` –≤—Å—ë –µ—â—ë –±–ª–æ–∫–∏—Ä—É–µ—Ç —Å—Ç–∞—Ä—Ç
   - –ù–µ—Ç —Ñ–æ–Ω–æ–≤–æ–π –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏
   - –ù–µ—Ç progress tracking

3. **Retry mechanisms** (Sprint 1.4)
   - –ù–µ—Ç retry –¥–ª—è Elasticsearch
   - –ù–µ—Ç exponential backoff
   - –ù–µ—Ç configurable retry

---

## üöÄ –°–ª–µ–¥—É—é—â–∏–π —Å–ø—Ä–∏–Ω—Ç: 1.2

**–¶–µ–ª—å:** –£–±—Ä–∞—Ç—å –≥–ª–æ–±–∞–ª—å–Ω—ã–µ —Å–∏–Ω–≥–ª—Ç–æ–Ω—ã –∏ –≤–Ω–µ–¥—Ä–∏—Ç—å –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π Dependency Injection

**–ó–∞–¥–∞—á–∏:**
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å async Depends –¥–ª—è `ElasticsearchClient`
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å Depends –¥–ª—è `MetricsCollector`
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å Depends –¥–ª—è `RateLimiter`
- [ ] –£–±—Ä–∞—Ç—å –≤—Å–µ –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑ –º–æ–¥—É–ª–µ–π
- [ ] –û–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ endpoints –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è DI
- [ ] –ù–∞–ø–∏—Å–∞—Ç—å unit —Ç–µ—Å—Ç—ã —Å mock'–∞–º–∏

**–û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:**
- –ù–µ—Ç –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö —Å–∏–Ω–≥–ª—Ç–æ–Ω–æ–≤
- –í—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —á–µ—Ä–µ–∑ FastAPI
- Lifecycle –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ context managers
- –õ–µ–≥–∫–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å mock'–∏ –¥–ª—è —Ç–µ—Å—Ç–æ–≤

---

## üìö –°—Å—ã–ª–∫–∏

- **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ:** `–¢–ï–•–ù–ò–ß–ï–°–ö–û–ï_–ó–ê–î–ê–ù–ò–ï_–†–ï–§–ê–ö–¢–û–†–ò–ù–ì.md`
- **–ö–æ–¥:** `src/main.py`, `src/api/*`
- **–¢–µ—Å—Ç—ã:** `tests/*`

---

**–ê–≤—Ç–æ—Ä:** GitHub Copilot  
**–†–µ–≤—å—é–µ—Ä:** Antonio1C  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É (–ø–æ—Å–ª–µ review)
